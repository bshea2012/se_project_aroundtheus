!function(){"use strict";const e=document.querySelector(".profile__add-button"),t=document.querySelector(".profile__edit-button"),s=(document.querySelector(".card__delete-button"),document.querySelector(".profile__avatar-edit-button")),i={profileName:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar"},r=".cards__list",n="#card-template",o="#preview-image-modal",a="#add-card-modal",l="#profile-edit-modal",u="#confirm-delete-modal",d="#avatar-edit-modal";class h{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleCardDeleteClick=i,this._handleCardLike=r}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>this._handleCardLike(this))),this._cardDelete=this._cardElement.querySelector(".card__delete-button"),this._cardDelete.addEventListener("click",(()=>this._handleCardDeleteClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}getCard(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardElement.querySelector(".card__description-content").textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._updateLikeButton(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}isCardLiked(e){this._isLiked=e,this._updateLikeButton()}isLiked(){return this._isLiked}_updateLikeButton(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleCardLike(){this._likeButton.classList.toggle("card__like-button_active")}}class _{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput(this._inputElements)?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class c{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._element=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._element.prepend(e)}}class m{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClose=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>this.close()))}}class p extends m{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}resetForm(){this._popupForm.reset()}}class E{constructor(e){let{profileName:t,profileDescription:s,profileAvatar:i}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,src:this._avatarElement.src}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}const v=new class extends m{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".card__image-preview"),this._popupCaption=this._popupElement.querySelector(".modal__heading-preview")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupCaption.textContent=e.name,super.open()}}(o),f=new p(a,(function(e){I((function(){return k.addNewCard(e.title,e.link).then((e=>{S.addItem(x(e)),f.resetForm()}))}),f)})),b=new p(l,(function(e){I((function(){return k.editUserInfo(e.title,e.description).then((()=>{g.setUserInfo(e.title,e.description)}))}),b)})),L=new p(d,(function(e){I((function(){return k.updateAvatar(e.link).then((()=>{g.setUserAvatar(e.link)}))}),L)})),C=new class extends m{constructor(e){super(e),this._closeConfirmForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button-delete"),this._submitButtonText=this._submitButton.textContent}setConfirmDelete(e){this._handleFormSubmit=e}setDeleteText(e){this._submitButton.textContent=e?"Deleting...":this._submitButtonText}setEventListeners(){super.setEventListeners(),this._closeConfirmForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}(u),k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}addNewCard(e,t){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}updateAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}updateLike(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}initialPageLoad(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2f5abbfd-693d-4973-87a8-2e8fc711af51","Content-Type":"application/json"}});let S,g,y;function B(e,t){v.open(e,t)}function I(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.setButtonText(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.setButtonText(!1)}))}function q(e){C.open(),C.setDeleteText(!1),C.setConfirmDelete((()=>{k.deleteCard(e._id).then((()=>{e.removeCard(),C.close()})).catch(console.error).finally((()=>{C.setDeleteText(!0)}))}))}function x(e){return new h(e,n,B,q,U).getCard()}function U(e){k.updateLike(e._id,e.isLiked()).then((t=>{e.isCardLiked(t.isLiked)})).catch(console.error)}v.setEventListeners(),f.setEventListeners(),b.setEventListeners(),L.setEventListeners(),C.setEventListeners(),k.initialPageLoad().then((e=>{let[t,s]=e;S=new c({items:s,renderer:e=>{S.addItem(x(e))}},r),S.renderItems(),g=new E(i),g.setUserInfo(t.name,t.about),g.setUserAvatar(t.avatar)})).catch((e=>{console.error("There is an Error: ",e)})),e.addEventListener("click",(()=>{T["place-form"].toggleButtonState(),f.open()})),t.addEventListener("click",(()=>{y=g.getUserInfo(),b.setInputValues({title:y.name,description:y.job}),T["profile-form"].resetValidation(),b.open()})),s.addEventListener("click",(()=>{y=g.getUserInfo(),L.setInputValues({link:y.src}),T["avatar-form"].toggleButtonState(),L.open()}));const T={};var w;w={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(".modal__form")).forEach((e=>{const t=new _(w,e),s=e.getAttribute("name");T[s]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SixFQUFXMUosRUFBWTJKLGFBQWEsUUFHMUNOLEVBQWVLLEdBQVlELEVBQzNCQSxFQUFVeEgsa0JBQWtCLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL0NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aFBpY3R1cmUuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwQ29uZmlybURlbGV0ZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhdGVtYXIuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19hdmF0YXItZWRpdC1idXR0b25cIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVTZWxlY3RvcnMgPSB7XHJcbiAgcHJvZmlsZU5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgcHJvZmlsZURlc2NyaXB0aW9uOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIHByb2ZpbGVBdmF0YXI6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBjYXJkU2VjdGlvbjogXCIuY2FyZHNfX2xpc3RcIixcclxuICBjYXJkVGVtcGxhdGU6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICBwcmV2aWV3TW9kYWw6IFwiI3ByZXZpZXctaW1hZ2UtbW9kYWxcIixcclxuICBuZXdDYXJkTW9kYWw6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgZWRpdFByb2ZpbGVNb2RhbDogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgY29uZmlybURlbGV0ZU1vZGFsOiBcIiNjb25maXJtLWRlbGV0ZS1tb2RhbFwiLFxyXG4gIGVkaXRBdmF0YXJNb2RhbDogXCIjYXZhdGFyLWVkaXQtbW9kYWxcIixcclxuICBlZGl0UHJvZmlsZUZvcm06IFwiI3Byb2ZpbGUtZm9ybVwiLFxyXG4gIGFkZENhcmRGb3JtOiBcIiNhZGQtY2FyZC1mb3JtXCIsXHJcbiAgZWRpdEF2YXRhckZvcm06IFwiI2F2YXRhci1mb3JtXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZExpa2VcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGVDbGljayA9IGhhbmRsZUNhcmREZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBDYXJkIExpa2UgQnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKHRoaXMpXHJcbiAgICApO1xyXG4gICAgLy8gQ2FyZCBEZWxldGUgQnV0dG9uXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZUNsaWNrKHRoaXMpXHJcbiAgICApO1xyXG4gICAgLy8gQ2FyZCBQcmV2aWV3XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICAvLyBDcmVhdGUgZnJvbSBUZW1wbGF0ZVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIC8vZ2V0IHRoZSBjYXJkIHZpZXdcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVzY3JpcHRpb24tY29udGVudFwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl91cGRhdGVMaWtlQnV0dG9uKCk7XHJcblxyXG4gICAgLy9yZXR1cm4gdGhlIGNhcmRcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGlzQ2FyZExpa2VkKGlzTGlrZWQpIHtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xyXG4gIH1cclxuXHJcbiAgX3VwZGF0ZUxpa2VCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDYXJkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxlbWVudHMpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNc2dFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZVJlbW90ZUNsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLnRhcmdldCA9PT0gZS5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIC8vIENyZWF0ZSBhbiBlbXB0eSBvYmplY3RcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHZhbHVlcyBvZiB0aGUgZmllbGRzIHRvIHRoaXMgb2JqZWN0XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSB2YWx1ZXMgb2JqZWN0XHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAvLyBIZXJlIHlvdSBpbnNlcnQgdGhlIGB2YWx1ZWAgYnkgdGhlIGBuYW1lYCBvZiB0aGUgaW5wdXRcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHNldEJ1dHRvblRleHQoaXNTYXZpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gICAgaWYgKGlzU2F2aW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2V0Rm9ybSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwcm9maWxlQXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZSk7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlRGVzY3JpcHRpb24pO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIHNyYzogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihzcmMpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gc3JjO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gSW1wb3J0IGFsbCBjbGFzc2VzXHJcbmltcG9ydCB7XHJcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcclxuICBlZGl0UHJvZmlsZUJ1dHRvbixcclxuICBlZGl0QXZhdGFyQnV0dG9uLFxyXG4gIHNlbGVjdG9ycyxcclxuICBwcm9maWxlU2VsZWN0b3JzLFxyXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcclxufSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhQaWN0dXJlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFBpY3R1cmVcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGVcIjtcclxuXHJcbi8vIENyZWF0ZSBpbnN0YW5jZXMgb2YgQ2xhc3Nlc1xyXG5jb25zdCBpbWFnZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhQaWN0dXJlKHNlbGVjdG9ycy5wcmV2aWV3TW9kYWwpO1xyXG5cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgc2VsZWN0b3JzLm5ld0NhcmRNb2RhbCxcclxuICBoYW5kbGVBZGRDYXJkU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0VXNlckluZm9Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHNlbGVjdG9ycy5lZGl0UHJvZmlsZU1vZGFsLFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuZWRpdEF2YXRhck1vZGFsLFxyXG4gIGhhbmRsZUF2YXRhckVkaXRTdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoc2VsZWN0b3JzLmNvbmZpcm1EZWxldGVNb2RhbCk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIyZjVhYmJmZC02OTNkLTQ5NzMtODdhOC0yZThmYzcxMWFmNTFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy9Jbml0aWFsaXplIGFsbCBpbnN0YW5jZXNcclxuaW1hZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRVc2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IHVzZXJJbmZvO1xyXG5cclxuYXBpXHJcbiAgLmluaXRpYWxQYWdlTG9hZCgpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVTZWxlY3RvcnMpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFRoZXJlIGlzIGFuIEVycm9yOiBgLCBlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgfSk7XHJcblxyXG4vL1NwZWNpZmljIEV2ZW50IExpc3RlbmVyc1xyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwbGFjZS1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5sZXQgdXNlckRhdGE7XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0VXNlckluZm9Qb3B1cC5zZXRJbnB1dFZhbHVlcyh7XHJcbiAgICB0aXRsZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5qb2IsXHJcbiAgfSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFVzZXJJbmZvUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnNldElucHV0VmFsdWVzKHtcclxuICAgIGxpbms6IHVzZXJEYXRhLnNyYyxcclxuICB9KTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbnNcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhsaW5rLCBuYW1lKSB7XHJcbiAgaW1hZ2VQcmV2aWV3UG9wdXAub3BlbihsaW5rLCBuYW1lKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gIHBvcHVwSW5zdGFuY2Uuc2V0QnV0dG9uVGV4dCh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xvc2Ugb25seSBpbiBgdGhlbmBcclxuICAgICAgcG9wdXBJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC8vIHdlIG5lZWQgdG8gY2F0Y2ggcG9zc2libGUgZXJyb3JzXHJcbiAgICAvLyBjb25zb2xlLmVycm9yIGlzIHVzZWQgdG8gaGFuZGxlIGVycm9ycyBpZiB5b3UgZG9u4oCZdCBoYXZlIGFueSBvdGhlciB3YXlzIGZvciB0aGF0XHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC8vIGluIGBmaW5hbGx5YCB3ZSBuZWVkIHRvIHJldHVybiB0aGUgaW5pdGlhbCBidXR0b24gdGV4dCBiYWNrIGluIGFueSBjYXNlXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2Uuc2V0QnV0dG9uVGV4dChmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgLy8gYHJldHVybmAgbGV0cyB1cyB1c2UgYSBwcm9taXNlIGNoYWluIGB0aGVuLCBjYXRjaCwgZmluYWxseWAgaW5zaWRlIGBoYW5kbGVTdWJtaXRgXHJcbiAgICByZXR1cm4gYXBpLmFkZE5ld0NhcmQoY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmxpbmspLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGEpKTtcclxuICAgICAgbmV3Q2FyZFBvcHVwLnJlc2V0Rm9ybSgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIG5ld0NhcmRQb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0KGNhcmREYXRhKSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmVkaXRVc2VySW5mbyhjYXJkRGF0YS50aXRsZSwgY2FyZERhdGEuZGVzY3JpcHRpb24pLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhjYXJkRGF0YS50aXRsZSwgY2FyZERhdGEuZGVzY3JpcHRpb24pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRVc2VySW5mb1BvcHVwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRWRpdFN1Ym1pdChkYXRhKSB7XHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLnVwZGF0ZUF2YXRhcihkYXRhLmxpbmspLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGRhdGEubGluayk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGhhbmRsZVN1Ym1pdChtYWtlUmVxdWVzdCwgZWRpdEF2YXRhclBvcHVwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZUNsaWNrKGNhcmQpIHtcclxuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXREZWxldGVUZXh0KGZhbHNlKTtcclxuICBkZWxldGVDYXJkUG9wdXAuc2V0Q29uZmlybURlbGV0ZSgoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0RGVsZXRlVGV4dCh0cnVlKTtcclxuICAgICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZUNhcmREZWxldGVDbGljayxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0Q2FyZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShkYXRhKSB7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlTGlrZShkYXRhLl9pZCwgZGF0YS5pc0xpa2VkKCkpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGRhdGEuaXNDYXJkTGlrZWQocmVzLmlzTGlrZWQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuLy9cclxuXHJcbi8vIFZhbGlkYXRpb25cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIikpO1xyXG5cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICAvLyBIZXJlIHlvdSBnZXQgdGhlIG5hbWUgb2YgdGhlIGZvcm0gKGlmIHlvdSBkb27igJl0IGhhdmUgaXQgdGhlbiB5b3UgbmVlZCB0byBhZGQgaXQgaW50byBlYWNoIGZvcm0gaW4gYGluZGV4Lmh0bWxgIGZpcnN0KVxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cclxuICAgIC8vIEhlcmUgeW91IHN0b3JlIHRoZSB2YWxpZGF0b3IgdXNpbmcgdGhlIGBuYW1lYCBvZiB0aGUgZm9ybVxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcclxuXHJcbi8vXHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoUGljdHVyZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZS1wcmV2aWV3XCIpO1xyXG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19oZWFkaW5nLXByZXZpZXdcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUNvbmZpcm1Gb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2J1dHRvbi1kZWxldGVcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBzZXRDb25maXJtRGVsZXRlKGZ1bmMpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBmdW5jO1xyXG4gIH1cclxuXHJcbiAgc2V0RGVsZXRlVGV4dChpc0RlbGV0aW5nKSB7XHJcbiAgICBpZiAoaXNEZWxldGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY2xvc2VDb25maXJtRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8odGl0bGUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB0aXRsZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGxpbmspIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxQYWdlTG9hZCgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJhZGROZXdDYXJkQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwicHJvZmlsZVNlbGVjdG9ycyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsInNlbGVjdG9ycyIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZUNsaWNrIiwiaGFuZGxlQ2FyZExpa2UiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUNhcmREZWxldGVDbGljayIsIl9oYW5kbGVDYXJkTGlrZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkRGVsZXRlIiwiX2NhcmRJbWFnZSIsImdldENhcmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJfdXBkYXRlTGlrZUJ1dHRvbiIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJpc0NhcmRMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInRvZ2dsZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwicmVzZXRWYWxpZGF0aW9uIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRFbGVtZW50cyIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNc2dFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiU2VjdGlvbiIsIl9yZWYiLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfZWxlbWVudCIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlUmVtb3RlQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2xvc2VCdXR0b24iLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInNldEJ1dHRvblRleHQiLCJpc1NhdmluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXRGb3JtIiwicmVzZXQiLCJVc2VySW5mbyIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImltYWdlUHJldmlld1BvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwibmV3Q2FyZFBvcHVwIiwiY2FyZERhdGEiLCJoYW5kbGVTdWJtaXQiLCJhcGkiLCJhZGROZXdDYXJkIiwidGl0bGUiLCJ0aGVuIiwiY2FyZFNlY3Rpb24iLCJjcmVhdGVDYXJkIiwiZWRpdFVzZXJJbmZvUG9wdXAiLCJlZGl0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInVzZXJJbmZvIiwiZWRpdEF2YXRhclBvcHVwIiwidXBkYXRlQXZhdGFyIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX2Nsb3NlQ29uZmlybUZvcm0iLCJzZXRDb25maXJtRGVsZXRlIiwiZnVuYyIsInNldERlbGV0ZVRleHQiLCJpc0RlbGV0aW5nIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJnZXRJbml0aWFsQ2FyZHMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZGVsZXRlQ2FyZCIsImF2YXRhciIsInVwZGF0ZUxpa2UiLCJpbml0aWFsUGFnZUxvYWQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwidXNlckRhdGEiLCJyZXF1ZXN0IiwicG9wdXBJbnN0YW5jZSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsImNhcmQiLCJjYXJkcyIsImVyciIsImZvcm1WYWxpZGF0b3JzIiwidmFsaWRhdGlvblNldHRpbmdzIiwiQXJyYXkiLCJmcm9tIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9