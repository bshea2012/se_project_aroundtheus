!function(){"use strict";const e=document.querySelector(".profile__add-button"),t=document.querySelector(".profile__edit-button"),s=(document.querySelector(".card__delete-button"),document.querySelector(".profile__avatar-edit-button")),r={profileName:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar"},i=".cards__list",n="#card-template",o="#preview-image-modal",a="#add-card-modal",l="#profile-edit-modal",d="#confirm-delete-modal",h="#avatar-edit-modal";class c{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleCardDeleteClick=r,this._handleCardLike=i}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>this._handleCardLike(this))),this._cardDelete=this._cardElement.querySelector(".card__delete-button"),this._cardDelete.addEventListener("click",(()=>this._handleCardDeleteClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}getCard(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardElement.querySelector(".card__description-content").textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._updateLikeButton(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}isCardLiked(e){this._isLiked=e,this._updateLikeButton()}_updateLikeButton(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleCardLike(){this._likeButton.classList.toggle("card__like-button_active")}}class u{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput(this._inputElements)?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class _{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._element=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._element.prepend(e)}}class m{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClose=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>this.close()))}}class p extends m{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()})),super.setEventListeners()}setButtonText(e){this._submitButtonText=e?"Saving":this._submitButton}}class E{constructor(e){let{profileName:t,profileDescription:s,profileAvatar:r}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(r)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,src:this._avatarElement.src}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}const v=new class extends m{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".card__image-preview"),this._popupCaption=this._popupElement.querySelector(".modal__heading-preview")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupCaption.textContent=e.name,super.open()}}(o),f=new p(a,(function(e){f.setButtonText(!0),C.addNewCard(e.title,e.link).then((()=>{S.addItem(q({name:e.title,link:e.link}))})).catch((e=>{console.error("There is an Error: ",e)})).finally((()=>{f.setButtonText(!1)})),f.close()})),k=new p(l,(function(e){k.setButtonText(!0),C.editUserInfo(e.title,e.description).then((()=>{y.setUserInfo(e.title,e.description)})).catch((e=>{console.error("There is an Error: ",e)})).finally((()=>{k.setButtonText(!1)})),k.close()})),b=new p(h,(function(e){b.setButtonText(!0),C.updateAvatar(e.link).then((()=>{y.setUserAvatar(e.link)})).catch((e=>{console.error("Avatar not updated: ",e)})).finally((()=>{b.setButtonText(!1)})),b.close()})),L=new class extends m{constructor(e){super(e),this._closeConfirmForm=this._popupElement.querySelector(".modal__form")}setConfirmDelete(e){this._handleFormSubmit=e}setEventListeners(){super.setEventListeners(),this._closeConfirmForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}(d),C=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).then(this._checkResponse)}editUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}addNewCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}updateLike(e,t){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers}).then(this._checkResponse)}initialPageLoad(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2f5abbfd-693d-4973-87a8-2e8fc711af51","Content-Type":"application/json"}});let S,y,g;function B(e,t){v.open(e,t)}function I(e){L.open(),L.setButtonText(!0),L.setConfirmDelete((()=>{C.deleteCard(e._id).then((()=>{e.removeCard(),L.close()})).catch((e=>{console.error("There is an Error: ",e)})).finally((()=>{L.setButtonText(!1)}))}))}function q(e){return new c(e,n,B,I,T).getCard()}function T(e){C.updateLike(e._id,e._isLiked).then((t=>{console.log(t.isLiked),e.isCardLiked(t.isLiked)})).catch((e=>{console.error("Card not liked: ",e)}))}v.setEventListeners(),f.setEventListeners(),k.setEventListeners(),b.setEventListeners(),L.setEventListeners(),C.initialPageLoad().then((e=>{let[t,s]=e;S=new _({items:s,renderer:e=>{S.addItem(q(e))}},i),S.renderItems(),y=new E(r),y.setUserInfo(t.name,t.about),y.setUserAvatar(t.avatar)})).catch((e=>{console.error("There is an Error: ",e)})),e.addEventListener("click",(()=>{U["place-form"].toggleButtonState(),f.open()})),t.addEventListener("click",(()=>{g=y.getUserInfo(),k.setInputValues({title:g.name,description:g.job}),U["profile-form"].resetValidation(),k.open()})),s.addEventListener("click",(()=>{g=y.getUserInfo(),b.setInputValues({link:g.src}),U["avatar-form"].toggleButtonState(),b.open()}));const U={};var x;x={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(".modal__form")).forEach((e=>{const t=new u(x,e),s=e.getAttribute("name");U[s]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhQaWN0dXJlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlU2VsZWN0b3JzID0ge1xyXG4gIHByb2ZpbGVOYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBwcm9maWxlQXZhdGFyOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19saXN0XCIsXHJcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgcHJldmlld01vZGFsOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXHJcbiAgbmV3Q2FyZE1vZGFsOiBcIiNhZGQtY2FyZC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWw6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGNvbmZpcm1EZWxldGVNb2RhbDogXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIixcclxuICBlZGl0QXZhdGFyTW9kYWw6IFwiI2F2YXRhci1lZGl0LW1vZGFsXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGRhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3IsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZExpa2VcclxuICApIHtcclxuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGVDbGljayA9IGhhbmRsZUNhcmREZWxldGVDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlID0gaGFuZGxlQ2FyZExpa2U7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvLyBDYXJkIExpa2UgQnV0dG9uXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRMaWtlKHRoaXMpXHJcbiAgICApO1xyXG4gICAgLy8gQ2FyZCBEZWxldGUgQnV0dG9uXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZERlbGV0ZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZUNsaWNrKHRoaXMpXHJcbiAgICApO1xyXG4gICAgLy8gQ2FyZCBQcmV2aWV3XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IGxpbms6IHRoaXMuX2xpbmssIG5hbWU6IHRoaXMuX25hbWUgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICAvLyBDcmVhdGUgZnJvbSBUZW1wbGF0ZVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgIC8vZ2V0IHRoZSBjYXJkIHZpZXdcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVzY3JpcHRpb24tY29udGVudFwiKS50ZXh0Q29udGVudCA9XHJcbiAgICAgIHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIC8vc2V0IGV2ZW50IGxpc3RlbmVyc1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl91cGRhdGVMaWtlQnV0dG9uKCk7XHJcblxyXG4gICAgLy9yZXR1cm4gdGhlIGNhcmRcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcclxuICB9XHJcblxyXG4gIGlzQ2FyZExpa2VkKGlzTGlrZWQpIHtcclxuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xyXG4gIH1cclxuXHJcbiAgX3VwZGF0ZUxpa2VCdXR0b24oKSB7XHJcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBoYW5kbGVDYXJkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0RWxlbWVudHMpKSB7XHJcbiAgICAgIHRoaXMuZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZW5hYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yTXNnRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNc2dFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gW1xyXG4gICAgICAuLi50aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpLFxyXG4gICAgXTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgc2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oaXRlbSkge1xyXG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlUmVtb3RlQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZVJlbW90ZUNsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLnRhcmdldCA9PT0gZS5jdXJyZW50VGFyZ2V0KSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIC8vIENyZWF0ZSBhbiBlbXB0eSBvYmplY3RcclxuICAgIGNvbnN0IGZvcm1WYWx1ZXMgPSB7fTtcclxuXHJcbiAgICAvLyBBZGQgdGhlIHZhbHVlcyBvZiB0aGUgZmllbGRzIHRvIHRoaXMgb2JqZWN0XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgZm9ybVZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUmV0dXJuIHRoZSB2YWx1ZXMgb2JqZWN0XHJcbiAgICByZXR1cm4gZm9ybVZhbHVlcztcclxuICB9XHJcblxyXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAvLyBIZXJlIHlvdSBpbnNlcnQgdGhlIGB2YWx1ZWAgYnkgdGhlIGBuYW1lYCBvZiB0aGUgaW5wdXRcclxuICAgICAgaW5wdXQudmFsdWUgPSBkYXRhW2lucHV0Lm5hbWVdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KGlzU2F2aW5nKSB7XHJcbiAgICBpZiAoaXNTYXZpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IFwiU2F2aW5nXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwcm9maWxlQXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZSk7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlRGVzY3JpcHRpb24pO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIHNyYzogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihzcmMpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gc3JjO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gSW1wb3J0IGFsbCBjbGFzc2VzXHJcbmltcG9ydCB7XHJcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcclxuICBlZGl0UHJvZmlsZUJ1dHRvbixcclxuICBlZGl0QXZhdGFyQnV0dG9uLFxyXG4gIHNlbGVjdG9ycyxcclxuICBwcm9maWxlU2VsZWN0b3JzLFxyXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcclxufSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhQaWN0dXJlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFBpY3R1cmVcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGVcIjtcclxuXHJcbi8vIENyZWF0ZSBpbnN0YW5jZXMgb2YgQ2xhc3Nlc1xyXG5jb25zdCBpbWFnZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhQaWN0dXJlKHNlbGVjdG9ycy5wcmV2aWV3TW9kYWwpO1xyXG5cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgc2VsZWN0b3JzLm5ld0NhcmRNb2RhbCxcclxuICBoYW5kbGVBZGRDYXJkU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0VXNlckluZm9Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHNlbGVjdG9ycy5lZGl0UHJvZmlsZU1vZGFsLFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuZWRpdEF2YXRhck1vZGFsLFxyXG4gIGhhbmRsZUF2YXRhckVkaXRTdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoc2VsZWN0b3JzLmNvbmZpcm1EZWxldGVNb2RhbCk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIyZjVhYmJmZC02OTNkLTQ5NzMtODdhOC0yZThmYzcxMWFmNTFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy9Jbml0aWFsaXplIGFsbCBpbnN0YW5jZXNcclxuaW1hZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRVc2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IHVzZXJJbmZvO1xyXG5cclxuYXBpXHJcbiAgLmluaXRpYWxQYWdlTG9hZCgpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVTZWxlY3RvcnMpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFRoZXJlIGlzIGFuIEVycm9yOiBgLCBlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgfSk7XHJcblxyXG4vL1NwZWNpZmljIEV2ZW50IExpc3RlbmVyc1xyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwbGFjZS1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5sZXQgdXNlckRhdGE7XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0VXNlckluZm9Qb3B1cC5zZXRJbnB1dFZhbHVlcyh7XHJcbiAgICB0aXRsZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5qb2IsXHJcbiAgfSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFVzZXJJbmZvUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnNldElucHV0VmFsdWVzKHtcclxuICAgIGxpbms6IHVzZXJEYXRhLnNyYyxcclxuICB9KTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbnNcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhsaW5rLCBuYW1lKSB7XHJcbiAgaW1hZ2VQcmV2aWV3UG9wdXAub3BlbihsaW5rLCBuYW1lKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIG5ld0NhcmRQb3B1cC5zZXRCdXR0b25UZXh0KHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZE5ld0NhcmQoY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmxpbmspXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oXHJcbiAgICAgICAgY3JlYXRlQ2FyZCh7IG5hbWU6IGNhcmREYXRhLnRpdGxlLCBsaW5rOiBjYXJkRGF0YS5saW5rIH0pXHJcbiAgICAgICk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihgVGhlcmUgaXMgYW4gRXJyb3I6IGAsIGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5zZXRCdXR0b25UZXh0KGZhbHNlKTtcclxuICAgIH0pO1xyXG5cclxuICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoY2FyZERhdGEpIHtcclxuICBlZGl0VXNlckluZm9Qb3B1cC5zZXRCdXR0b25UZXh0KHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyhjYXJkRGF0YS50aXRsZSwgY2FyZERhdGEuZGVzY3JpcHRpb24pXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGNhcmREYXRhLnRpdGxlLCBjYXJkRGF0YS5kZXNjcmlwdGlvbik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihgVGhlcmUgaXMgYW4gRXJyb3I6IGAsIGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGVkaXRVc2VySW5mb1BvcHVwLnNldEJ1dHRvblRleHQoZmFsc2UpO1xyXG4gICAgfSk7XHJcbiAgZWRpdFVzZXJJbmZvUG9wdXAuY2xvc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZERlbGV0ZUNsaWNrKGNhcmQpIHtcclxuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRCdXR0b25UZXh0KHRydWUpO1xyXG4gIGRlbGV0ZUNhcmRQb3B1cC5zZXRDb25maXJtRGVsZXRlKCgpID0+IHtcclxuICAgIGFwaVxyXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLl9pZClcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYFRoZXJlIGlzIGFuIEVycm9yOiBgLCBlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgICAgIH0pXHJcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0QnV0dG9uVGV4dChmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJFZGl0U3VibWl0KGRhdGEpIHtcclxuICBlZGl0QXZhdGFyUG9wdXAuc2V0QnV0dG9uVGV4dCh0cnVlKTtcclxuICBhcGlcclxuICAgIC51cGRhdGVBdmF0YXIoZGF0YS5saW5rKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKGRhdGEubGluayk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihgQXZhdGFyIG5vdCB1cGRhdGVkOiBgLCBlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBlZGl0QXZhdGFyUG9wdXAuc2V0QnV0dG9uVGV4dChmYWxzZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZUNhcmREZWxldGVDbGljayxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0Q2FyZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShkYXRhKSB7XHJcbiAgLy8gY29uc29sZS5sb2coZGF0YSk7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlTGlrZShkYXRhLl9pZCwgZGF0YS5faXNMaWtlZClcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzLmlzTGlrZWQpO1xyXG4gICAgICBkYXRhLmlzQ2FyZExpa2VkKHJlcy5pc0xpa2VkKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGBDYXJkIG5vdCBsaWtlZDogYCwgZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vXHJcblxyXG4vLyBWYWxpZGF0aW9uXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHZhbGlkYXRpb25TZXR0aW5ncykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19mb3JtXCIpKTtcclxuXHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZm9ybUVsZW1lbnQpO1xyXG4gICAgLy8gSGVyZSB5b3UgZ2V0IHRoZSBuYW1lIG9mIHRoZSBmb3JtIChpZiB5b3UgZG9u4oCZdCBoYXZlIGl0IHRoZW4geW91IG5lZWQgdG8gYWRkIGl0IGludG8gZWFjaCBmb3JtIGluIGBpbmRleC5odG1sYCBmaXJzdClcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuXHJcbiAgICAvLyBIZXJlIHlvdSBzdG9yZSB0aGUgdmFsaWRhdG9yIHVzaW5nIHRoZSBgbmFtZWAgb2YgdGhlIGZvcm1cclxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcclxuICAgIHZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG5lbmFibGVWYWxpZGF0aW9uKHZhbGlkYXRpb25TZXR0aW5ncyk7XHJcblxyXG4vL1xyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aFBpY3R1cmUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2UtcHJldmlld1wiKTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9faGVhZGluZy1wcmV2aWV3XCJcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBvcGVuKGRhdGEpIHtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5hbHQgPSBkYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBDb25maXJtRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VDb25maXJtRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0Q29uZmlybURlbGV0ZShmdW5jKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gZnVuYztcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX2Nsb3NlQ29uZmlybUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZWRpdFVzZXJJbmZvKHRpdGxlLCBkZXNjcmlwdGlvbikge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHRpdGxlLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZShpZCwgaXNMaWtlZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBpbml0aWFsUGFnZUxvYWQoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiYWRkTmV3Q2FyZEJ1dHRvbiIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImVkaXRQcm9maWxlQnV0dG9uIiwiZWRpdEF2YXRhckJ1dHRvbiIsInByb2ZpbGVTZWxlY3RvcnMiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVEZXNjcmlwdGlvbiIsInByb2ZpbGVBdmF0YXIiLCJzZWxlY3RvcnMiLCJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZUNhcmREZWxldGVDbGljayIsImhhbmRsZUNhcmRMaWtlIiwidGhpcyIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVDYXJkRGVsZXRlQ2xpY2siLCJfaGFuZGxlQ2FyZExpa2UiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsIl9jYXJkRWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfY2FyZERlbGV0ZSIsIl9jYXJkSW1hZ2UiLCJnZXRDYXJkIiwiY29udGVudCIsImNsb25lTm9kZSIsInNyYyIsInRleHRDb250ZW50IiwiYWx0IiwiX3VwZGF0ZUxpa2VCdXR0b24iLCJyZW1vdmVDYXJkIiwicmVtb3ZlIiwiaXNDYXJkTGlrZWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ0b2dnbGUiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9mb3JtRWxlbWVudCIsInJlc2V0VmFsaWRhdGlvbiIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2lucHV0RWxlbWVudHMiLCJmb3JFYWNoIiwiaW5wdXRFbGVtZW50IiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX3N1Ym1pdEJ1dHRvbiIsImRpc2FibGVkIiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsIl9zaG93SW5wdXRFcnJvciIsImVycm9yTXNnRWxlbWVudCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJfcmVmIiwic2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2VsZW1lbnQiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJpdGVtIiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZVJlbW90ZUNsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5IiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsInNldEV2ZW50TGlzdGVuZXJzIiwiX2Nsb3NlQnV0dG9uIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfc3VibWl0QnV0dG9uVGV4dCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0TGlzdCIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1WYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJyZXNldCIsInNldEJ1dHRvblRleHQiLCJpc1NhdmluZyIsIlVzZXJJbmZvIiwiX25hbWVFbGVtZW50IiwiX2pvYkVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwiam9iIiwic2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiaW1hZ2VQcmV2aWV3UG9wdXAiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cENhcHRpb24iLCJuZXdDYXJkUG9wdXAiLCJjYXJkRGF0YSIsImFwaSIsImFkZE5ld0NhcmQiLCJ0aXRsZSIsInRoZW4iLCJjYXJkU2VjdGlvbiIsImNyZWF0ZUNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJlZGl0VXNlckluZm9Qb3B1cCIsImVkaXRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwidXNlckluZm8iLCJlZGl0QXZhdGFyUG9wdXAiLCJ1cGRhdGVBdmF0YXIiLCJkZWxldGVDYXJkUG9wdXAiLCJfY2xvc2VDb25maXJtRm9ybSIsInNldENvbmZpcm1EZWxldGUiLCJmdW5jIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZGVsZXRlQ2FyZCIsImF2YXRhciIsInVwZGF0ZUxpa2UiLCJpbml0aWFsUGFnZUxvYWQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwidXNlckRhdGEiLCJjYXJkIiwibG9nIiwiY2FyZHMiLCJmb3JtVmFsaWRhdG9ycyIsInZhbGlkYXRpb25TZXR0aW5ncyIsIkFycmF5IiwiZnJvbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==