!function(){"use strict";const e=document.querySelector(".profile__add-button"),t=document.querySelector(".profile__edit-button"),s=(document.querySelector(".card__delete-button"),document.querySelector(".profile__avatar-edit-button")),i={profileName:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar"},r=".cards__list",n="#card-template",o="#preview-image-modal",a="#add-card-modal",l="#profile-edit-modal",u="#confirm-delete-modal",d="#avatar-edit-modal";class h{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleCardDeleteClick=i,this._handleCardLike=r}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>this._handleCardLike(this))),this._cardDelete=this._cardElement.querySelector(".card__delete-button"),this._cardDelete.addEventListener("click",(()=>this._handleCardDeleteClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}getCard(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardElement.querySelector(".card__description-content").textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._updateLikeButton(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}isCardLiked(e){this._isLiked=e,this._updateLikeButton()}isLiked(){return this._isLiked}_updateLikeButton(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleCardLike(){this._likeButton.classList.toggle("card__like-button_active")}}class _{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput(this._inputElements)?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class c{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._element=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._element.prepend(e)}}class m{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClose=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>this.close()))}}class p extends m{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}resetForm(){this._popupForm.reset()}}class E{constructor(e){let{profileName:t,profileDescription:s,profileAvatar:i}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,src:this._avatarElement.src}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}const v=new class extends m{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".card__image-preview"),this._popupCaption=this._popupElement.querySelector(".modal__heading-preview")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupCaption.textContent=e.name,super.open()}}(o),f=new p(a,(function(e){I((function(){return k.addNewCard(e.title,e.link).then((e=>{S.addItem(U(e)),f.resetForm()}))}),f)})),b=new p(l,(function(e){I((function(){return k.editUserInfo(e.title,e.description).then((()=>{g.setUserInfo(e.title,e.description)}))}),b)})),L=new p(d,(function(e){I((function(){return k.updateAvatar(e.link).then((()=>{g.setUserAvatar(e.link)}))}),L)})),C=new class extends m{constructor(e){super(e),this._closeConfirmForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button-delete"),this._submitButtonText=this._submitButton.textContent}setConfirmDelete(e){this._handleFormSubmit=e}setButtonText(e){this._submitButton.textContent=e?"Deleting...":this._submitButtonText}setEventListeners(){super.setEventListeners(),this._closeConfirmForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}(u),k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}addNewCard(e,t){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}updateAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}updateLike(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}initialPageLoad(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2f5abbfd-693d-4973-87a8-2e8fc711af51","Content-Type":"application/json"}});let S,g,B;function y(e,t){v.open(e,t)}function I(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.setButtonText(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.setButtonText(!1)}))}function q(e){function t(){return k.deleteCard(e._id).then((()=>{e.removeCard()}))}C.open(),C.setConfirmDelete((()=>{I(t,C,"Deleting...")}))}function U(e){return new h(e,n,y,q,x).getCard()}function x(e){k.updateLike(e._id,e.isLiked()).then((t=>{e.isCardLiked(t.isLiked)})).catch(console.error)}v.setEventListeners(),f.setEventListeners(),b.setEventListeners(),L.setEventListeners(),C.setEventListeners(),k.initialPageLoad().then((e=>{let[t,s]=e;S=new c({items:s,renderer:e=>{S.addItem(U(e))}},r),S.renderItems(),g=new E(i),g.setUserInfo(t.name,t.about),g.setUserAvatar(t.avatar)})).catch((e=>{console.error("There is an Error: ",e)})),e.addEventListener("click",(()=>{w["place-form"].toggleButtonState(),f.open()})),t.addEventListener("click",(()=>{B=g.getUserInfo(),b.setInputValues({title:B.name,description:B.job}),w["profile-form"].resetValidation(),b.open()})),s.addEventListener("click",(()=>{B=g.getUserInfo(),L.setInputValues({link:B.src}),w["avatar-form"].toggleButtonState(),L.open()}));const w={};var T;T={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(".modal__form")).forEach((e=>{const t=new _(T,e),s=e.getAttribute("name");w[s]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxFQUMzQkEsRUFBVXhILGtCQUFrQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9Db25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhQaWN0dXJlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGUuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGNhcmREZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIucHJvZmlsZV9fYXZhdGFyLWVkaXQtYnV0dG9uXCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlU2VsZWN0b3JzID0ge1xyXG4gIHByb2ZpbGVOYW1lOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBwcm9maWxlQXZhdGFyOiBcIi5wcm9maWxlX19hdmF0YXJcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19saXN0XCIsXHJcbiAgY2FyZFRlbXBsYXRlOiBcIiNjYXJkLXRlbXBsYXRlXCIsXHJcbiAgcHJldmlld01vZGFsOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXHJcbiAgbmV3Q2FyZE1vZGFsOiBcIiNhZGQtY2FyZC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWw6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGNvbmZpcm1EZWxldGVNb2RhbDogXCIjY29uZmlybS1kZWxldGUtbW9kYWxcIixcclxuICBlZGl0QXZhdGFyTW9kYWw6IFwiI2F2YXRhci1lZGl0LW1vZGFsXCIsXHJcbiAgZWRpdFByb2ZpbGVGb3JtOiBcIiNwcm9maWxlLWZvcm1cIixcclxuICBhZGRDYXJkRm9ybTogXCIjYWRkLWNhcmQtZm9ybVwiLFxyXG4gIGVkaXRBdmF0YXJGb3JtOiBcIiNhdmF0YXItZm9ybVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHZhbGlkYXRpb25TZXR0aW5ncyA9IHtcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBkYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZUNhcmREZWxldGVDbGljayxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlQ2xpY2sgPSBoYW5kbGVDYXJkRGVsZXRlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy8gQ2FyZCBMaWtlIEJ1dHRvblxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSh0aGlzKVxyXG4gICAgKTtcclxuICAgIC8vIENhcmQgRGVsZXRlIEJ1dHRvblxyXG4gICAgdGhpcy5fY2FyZERlbGV0ZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmREZWxldGUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmREZWxldGVDbGljayh0aGlzKVxyXG4gICAgKTtcclxuICAgIC8vIENhcmQgUHJldmlld1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBsaW5rOiB0aGlzLl9saW5rLCBuYW1lOiB0aGlzLl9uYW1lIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkKCkge1xyXG4gICAgLy8gQ3JlYXRlIGZyb20gVGVtcGxhdGVcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2Rlc2NyaXB0aW9uLWNvbnRlbnRcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcbiAgICAvL3NldCBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fdXBkYXRlTGlrZUJ1dHRvbigpO1xyXG5cclxuICAgIC8vcmV0dXJuIHRoZSBjYXJkXHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICByZW1vdmVDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgfVxyXG5cclxuICBpc0NhcmRMaWtlZChpc0xpa2VkKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF91cGRhdGVMaWtlQnV0dG9uKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgaGFuZGxlQ2FyZExpa2UoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCh0aGlzLl9pbnB1dEVsZW1lbnRzKSkge1xyXG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2VuYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBkaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiAhdGhpcy5faW5wdXRFbGVtZW50cy5ldmVyeShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNc2dFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JNc2dFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvck1zZ0VsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNc2dFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICAgIGVycm9yTXNnRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFtcclxuICAgICAgLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSxcclxuICAgIF07XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIHNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVJlbW90ZUNsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZVJlbW90ZUNsb3NlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVSZW1vdGVDbG9zZSA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25UZXh0ID0gdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAvLyBDcmVhdGUgYW4gZW1wdHkgb2JqZWN0XHJcbiAgICBjb25zdCBmb3JtVmFsdWVzID0ge307XHJcblxyXG4gICAgLy8gQWRkIHRoZSB2YWx1ZXMgb2YgdGhlIGZpZWxkcyB0byB0aGlzIG9iamVjdFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIFJldHVybiB0aGUgdmFsdWVzIG9iamVjdFxyXG4gICAgcmV0dXJuIGZvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRJbnB1dFZhbHVlcyhkYXRhKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgLy8gSGVyZSB5b3UgaW5zZXJ0IHRoZSBgdmFsdWVgIGJ5IHRoZSBgbmFtZWAgb2YgdGhlIGlucHV0XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KGlzU2F2aW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc1NhdmluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldEZvcm0oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVEZXNjcmlwdGlvbiwgcHJvZmlsZUF2YXRhciB9KSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWUpO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZURlc2NyaXB0aW9uKTtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVBdmF0YXIpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgICAgam9iOiB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBzcmM6IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKG5hbWUsIGpvYikge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iRWxlbWVudC50ZXh0Q29udGVudCA9IGpvYjtcclxuICB9XHJcblxyXG4gIHNldFVzZXJBdmF0YXIoc3JjKSB7XHJcbiAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IHNyYztcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbi8vIEltcG9ydCBhbGwgY2xhc3Nlc1xyXG5pbXBvcnQge1xyXG4gIGFkZE5ld0NhcmRCdXR0b24sXHJcbiAgZWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgZWRpdEF2YXRhckJ1dHRvbixcclxuICBzZWxlY3RvcnMsXHJcbiAgcHJvZmlsZVNlbGVjdG9ycyxcclxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL0NvbnN0YW50c1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3JcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvblwiO1xyXG5pbXBvcnQgUG9wdXBXaXRoUGljdHVyZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhQaWN0dXJlXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1cIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpXCI7XHJcbmltcG9ydCBQb3B1cENvbmZpcm1EZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlXCI7XHJcblxyXG4vLyBDcmVhdGUgaW5zdGFuY2VzIG9mIENsYXNzZXNcclxuY29uc3QgaW1hZ2VQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoUGljdHVyZShzZWxlY3RvcnMucHJldmlld01vZGFsKTtcclxuXHJcbmNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHNlbGVjdG9ycy5uZXdDYXJkTW9kYWwsXHJcbiAgaGFuZGxlQWRkQ2FyZFN1Ym1pdFxyXG4pO1xyXG5cclxuY29uc3QgZWRpdFVzZXJJbmZvUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuZWRpdFByb2ZpbGVNb2RhbCxcclxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxyXG4pO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgc2VsZWN0b3JzLmVkaXRBdmF0YXJNb2RhbCxcclxuICBoYW5kbGVBdmF0YXJFZGl0U3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBDb25maXJtRGVsZXRlKHNlbGVjdG9ycy5jb25maXJtRGVsZXRlTW9kYWwpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiMmY1YWJiZmQtNjkzZC00OTczLTg3YTgtMmU4ZmM3MTFhZjUxXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbi8vSW5pdGlhbGl6ZSBhbGwgaW5zdGFuY2VzXHJcbmltYWdlUHJldmlld1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0VXNlckluZm9Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuZGVsZXRlQ2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5sZXQgY2FyZFNlY3Rpb247XHJcbmxldCB1c2VySW5mbztcclxuXHJcbmFwaVxyXG4gIC5pbml0aWFsUGFnZUxvYWQoKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRzXSkgPT4ge1xyXG4gICAgY2FyZFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkcyxcclxuICAgICAgICByZW5kZXJlcjogKGl0ZW0pID0+IHtcclxuICAgICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChpdGVtKSk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgc2VsZWN0b3JzLmNhcmRTZWN0aW9uXHJcbiAgICApO1xyXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuXHJcbiAgICB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhwcm9maWxlU2VsZWN0b3JzKTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmVycm9yKGBUaGVyZSBpcyBhbiBFcnJvcjogYCwgZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG4gIH0pO1xyXG5cclxuLy9TcGVjaWZpYyBFdmVudCBMaXN0ZW5lcnNcclxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicGxhY2UtZm9ybVwiXS50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxubGV0IHVzZXJEYXRhO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdFVzZXJJbmZvUG9wdXAuc2V0SW5wdXRWYWx1ZXMoe1xyXG4gICAgdGl0bGU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICBkZXNjcmlwdGlvbjogdXNlckRhdGEuam9iLFxyXG4gIH0pO1xyXG4gIGZvcm1WYWxpZGF0b3JzW1wicHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIGVkaXRVc2VySW5mb1BvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5zZXRJbnB1dFZhbHVlcyh7XHJcbiAgICBsaW5rOiB1c2VyRGF0YS5zcmMsXHJcbiAgfSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJhdmF0YXItZm9ybVwiXS50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gRnVuY3Rpb25zXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobGluaywgbmFtZSkge1xyXG4gIGltYWdlUHJldmlld1BvcHVwLm9wZW4obGluaywgbmFtZSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChyZXF1ZXN0LCBwb3B1cEluc3RhbmNlLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICBwb3B1cEluc3RhbmNlLnNldEJ1dHRvblRleHQodHJ1ZSwgbG9hZGluZ1RleHQpO1xyXG4gIHJlcXVlc3QoKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAvLyBXZSBuZWVkIHRvIGNsb3NlIG9ubHkgaW4gYHRoZW5gXHJcbiAgICAgIHBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAvLyB3ZSBuZWVkIHRvIGNhdGNoIHBvc3NpYmxlIGVycm9yc1xyXG4gICAgLy8gY29uc29sZS5lcnJvciBpcyB1c2VkIHRvIGhhbmRsZSBlcnJvcnMgaWYgeW91IGRvbuKAmXQgaGF2ZSBhbnkgb3RoZXIgd2F5cyBmb3IgdGhhdFxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAvLyBpbiBgZmluYWxseWAgd2UgbmVlZCB0byByZXR1cm4gdGhlIGluaXRpYWwgYnV0dG9uIHRleHQgYmFjayBpbiBhbnkgY2FzZVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwb3B1cEluc3RhbmNlLnNldEJ1dHRvblRleHQoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoY2FyZERhdGEpIHtcclxuICBmdW5jdGlvbiBtYWtlUmVxdWVzdCgpIHtcclxuICAgIC8vIGByZXR1cm5gIGxldHMgdXMgdXNlIGEgcHJvbWlzZSBjaGFpbiBgdGhlbiwgY2F0Y2gsIGZpbmFsbHlgIGluc2lkZSBgaGFuZGxlU3VibWl0YFxyXG4gICAgcmV0dXJuIGFwaS5hZGROZXdDYXJkKGNhcmREYXRhLnRpdGxlLCBjYXJkRGF0YS5saW5rKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XHJcbiAgICAgIG5ld0NhcmRQb3B1cC5yZXNldEZvcm0oKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBuZXdDYXJkUG9wdXApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgcmV0dXJuIGFwaS5lZGl0VXNlckluZm8oY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmRlc2NyaXB0aW9uKS50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmRlc2NyaXB0aW9uKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBlZGl0VXNlckluZm9Qb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckVkaXRTdWJtaXQoZGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgcmV0dXJuIGFwaS51cGRhdGVBdmF0YXIoZGF0YS5saW5rKS50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmxpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRBdmF0YXJQb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmREZWxldGVDbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuXHJcbiAgZnVuY3Rpb24gbWFrZVJlcXVlc3QoKSB7XHJcbiAgICByZXR1cm4gYXBpLmRlbGV0ZUNhcmQoY2FyZC5faWQpLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldENvbmZpcm1EZWxldGUoKCkgPT4ge1xyXG4gICAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBkZWxldGVDYXJkUG9wdXAsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAgY2FyZERhdGEsXHJcbiAgICBzZWxlY3RvcnMuY2FyZFRlbXBsYXRlLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZUNhcmREZWxldGVDbGljayxcclxuICAgIGhhbmRsZUNhcmRMaWtlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0Q2FyZCgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShkYXRhKSB7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlTGlrZShkYXRhLl9pZCwgZGF0YS5pc0xpa2VkKCkpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGRhdGEuaXNDYXJkTGlrZWQocmVzLmlzTGlrZWQpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcclxufVxyXG5cclxuLy9cclxuXHJcbi8vIFZhbGlkYXRpb25cclxuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcclxuXHJcbmNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAodmFsaWRhdGlvblNldHRpbmdzKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Zvcm1cIikpO1xyXG5cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCk7XHJcbiAgICAvLyBIZXJlIHlvdSBnZXQgdGhlIG5hbWUgb2YgdGhlIGZvcm0gKGlmIHlvdSBkb27igJl0IGhhdmUgaXQgdGhlbiB5b3UgbmVlZCB0byBhZGQgaXQgaW50byBlYWNoIGZvcm0gaW4gYGluZGV4Lmh0bWxgIGZpcnN0KVxyXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xyXG5cclxuICAgIC8vIEhlcmUgeW91IHN0b3JlIHRoZSB2YWxpZGF0b3IgdXNpbmcgdGhlIGBuYW1lYCBvZiB0aGUgZm9ybVxyXG4gICAgZm9ybVZhbGlkYXRvcnNbZm9ybU5hbWVdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcclxuXHJcbi8vXHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoUGljdHVyZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZS1wcmV2aWV3XCIpO1xyXG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19oZWFkaW5nLXByZXZpZXdcIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW4oZGF0YSkge1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cENvbmZpcm1EZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jbG9zZUNvbmZpcm1Gb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2J1dHRvbi1kZWxldGVcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgfVxyXG5cclxuICBzZXRDb25maXJtRGVsZXRlKGZ1bmMpIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBmdW5jO1xyXG4gIH1cclxuXHJcbiAgc2V0QnV0dG9uVGV4dChpc0RlbGV0aW5nKSB7XHJcbiAgICBpZiAoaXNEZWxldGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIkRlbGV0aW5nLi4uXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fY2xvc2VDb25maXJtRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCgpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8odGl0bGUsIGRlc2NyaXB0aW9uKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB0aXRsZSxcclxuICAgICAgICBhYm91dDogZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdDYXJkKG5hbWUsIGxpbmspIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICBsaW5rOiBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGxpbmspIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVMaWtlKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGluaXRpYWxQYWdlTG9hZCgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRVc2VySW5mbygpLCB0aGlzLmdldEluaXRpYWxDYXJkcygpXSk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJhZGROZXdDYXJkQnV0dG9uIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwicHJvZmlsZVNlbGVjdG9ycyIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsInNlbGVjdG9ycyIsIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlQ2FyZERlbGV0ZUNsaWNrIiwiaGFuZGxlQ2FyZExpa2UiLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUNhcmREZWxldGVDbGljayIsIl9oYW5kbGVDYXJkTGlrZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9jYXJkRGVsZXRlIiwiX2NhcmRJbWFnZSIsImdldENhcmQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwic3JjIiwidGV4dENvbnRlbnQiLCJhbHQiLCJfdXBkYXRlTGlrZUJ1dHRvbiIsInJlbW92ZUNhcmQiLCJyZW1vdmUiLCJpc0NhcmRMaWtlZCIsImNsYXNzTGlzdCIsImFkZCIsInRvZ2dsZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwicmVzZXRWYWxpZGF0aW9uIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRFbGVtZW50cyIsImZvckVhY2giLCJpbnB1dEVsZW1lbnQiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfc3VibWl0QnV0dG9uIiwiZGlzYWJsZWQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3Nob3dJbnB1dEVycm9yIiwiZXJyb3JNc2dFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiU2VjdGlvbiIsIl9yZWYiLCJzZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfZWxlbWVudCIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJfaGFuZGxlUmVtb3RlQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2xvc2VCdXR0b24iLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9zdWJtaXRCdXR0b25UZXh0IiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRMaXN0IiwiX2dldElucHV0VmFsdWVzIiwiZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRJbnB1dFZhbHVlcyIsInNldEJ1dHRvblRleHQiLCJpc1NhdmluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXRGb3JtIiwicmVzZXQiLCJVc2VySW5mbyIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImltYWdlUHJldmlld1BvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwibmV3Q2FyZFBvcHVwIiwiY2FyZERhdGEiLCJoYW5kbGVTdWJtaXQiLCJhcGkiLCJhZGROZXdDYXJkIiwidGl0bGUiLCJ0aGVuIiwiY2FyZFNlY3Rpb24iLCJjcmVhdGVDYXJkIiwiZWRpdFVzZXJJbmZvUG9wdXAiLCJlZGl0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInVzZXJJbmZvIiwiZWRpdEF2YXRhclBvcHVwIiwidXBkYXRlQXZhdGFyIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX2Nsb3NlQ29uZmlybUZvcm0iLCJzZXRDb25maXJtRGVsZXRlIiwiZnVuYyIsImlzRGVsZXRpbmciLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJfcmVxdWVzdCIsInVybCIsIm9wdGlvbnMiLCJmZXRjaCIsImdldEluaXRpYWxDYXJkcyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZWxldGVDYXJkIiwiYXZhdGFyIiwidXBkYXRlTGlrZSIsImluaXRpYWxQYWdlTG9hZCIsImFsbCIsImF1dGhvcml6YXRpb24iLCJ1c2VyRGF0YSIsInJlcXVlc3QiLCJwb3B1cEluc3RhbmNlIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJmaW5hbGx5IiwiY2FyZCIsIm1ha2VSZXF1ZXN0IiwiY2FyZHMiLCJlcnIiLCJmb3JtVmFsaWRhdG9ycyIsInZhbGlkYXRpb25TZXR0aW5ncyIsIkFycmF5IiwiZnJvbSIsInZhbGlkYXRvciIsImZvcm1OYW1lIiwiZ2V0QXR0cmlidXRlIl0sInNvdXJjZVJvb3QiOiIifQ==