!function(){"use strict";const e=document.querySelector(".profile__add-button"),t=document.querySelector(".profile__edit-button"),s=(document.querySelector(".card__delete-button"),document.querySelector(".profile__avatar-edit-button")),i={profileName:".profile__title",profileDescription:".profile__description",profileAvatar:".profile__avatar"},r=".cards__list",n="#card-template",o="#preview-image-modal",a="#add-card-modal",l="#profile-edit-modal",u="#confirm-delete-modal",d="#avatar-edit-modal";class h{constructor(e,t,s,i,r){this._name=e.name,this._link=e.link,this._id=e._id,this._isLiked=e.isLiked,this._cardSelector=t,this._handleImageClick=s,this._handleCardDeleteClick=i,this._handleCardLike=r}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>this._handleCardLike(this))),this._cardDelete=this._cardElement.querySelector(".card__delete-button"),this._cardDelete.addEventListener("click",(()=>this._handleCardDeleteClick(this))),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({link:this._link,name:this._name})}))}getCard(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardImage.src=this._link,this._cardElement.querySelector(".card__description-content").textContent=this._name,this._cardImage.alt=this._name,this._setEventListeners(),this._updateLikeButton(),this._cardElement}removeCard(){this._cardElement.remove(),this._cardElement=null}isCardLiked(e){this._isLiked=e,this._updateLikeButton()}_updateLikeButton(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleCardLike(){this._likeButton.classList.toggle("card__like-button_active")}}class _{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t}resetValidation(){this.toggleButtonState(),this._inputElements.forEach((e=>{this._hideInputError(e)}))}toggleButtonState(){this._hasInvalidInput(this._inputElements)?this.disableButton():this._enableButton()}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_setEventListeners(){this._inputElements=[...this._formElement.querySelectorAll(this._inputSelector)],this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class c{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._element=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._element.prepend(e)}}class m{constructor(e){this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose),this._popupElement.addEventListener("click",this._handleRemoteClose)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose),this._popupElement.removeEventListener("click",this._handleRemoteClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleRemoteClose=e=>{e.target===e.currentTarget&&this.close()};setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>this.close()))}}class p extends m{constructor(e,t){super(e),this._popupForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent,this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}setButtonText(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}}class E{constructor(e){let{profileName:t,profileDescription:s,profileAvatar:i}=e;this._nameElement=document.querySelector(t),this._jobElement=document.querySelector(s),this._avatarElement=document.querySelector(i)}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,src:this._avatarElement.src}}setUserInfo(e,t){this._nameElement.textContent=e,this._jobElement.textContent=t}setUserAvatar(e){this._avatarElement.src=e}}const v=new class extends m{constructor(e){super(e),this._popupImage=this._popupElement.querySelector(".card__image-preview"),this._popupCaption=this._popupElement.querySelector(".modal__heading-preview")}open(e){this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupCaption.textContent=e.name,super.open()}}(o),f=new p(a,(function(e){I((function(){return k.addNewCard(e.title,e.link).then((e=>{S.addItem(x(e))}))}),f)})),b=new p(l,(function(e){I((function(){return k.editUserInfo(e.title,e.description).then((()=>{g.setUserInfo(e.title,e.description)}))}),b)})),L=new p(d,(function(e){I((function(){return k.updateAvatar(e.link).then((()=>{g.setUserAvatar(e.link)}))}),L)})),C=new class extends m{constructor(e){super(e),this._closeConfirmForm=this._popupElement.querySelector(".modal__form"),this._submitButton=this._popupElement.querySelector(".modal__button-delete"),this._submitButtonText=this._submitButton.textContent}setConfirmDelete(e){this._handleFormSubmit=e}setDeleteText(e){this._submitButton.textContent=e?"Deleting...":this._submitButtonText}setEventListeners(){super.setEventListeners(),this._closeConfirmForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit()}))}}(u),k=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers})}editUserInfo(e,t){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})})}addNewCard(e,t){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers})}updateAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})})}updateLike(e,t){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:t?"DELETE":"PUT",headers:this._headers})}initialPageLoad(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"2f5abbfd-693d-4973-87a8-2e8fc711af51","Content-Type":"application/json"}});let S,g,y;function B(e,t){v.open(e,t)}function I(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.setButtonText(!0,s),e().then((()=>{t.close()})).catch(console.error).finally((()=>{t.setButtonText(!1)}))}function q(e){C.open(),C.setConfirmDelete((()=>{k.deleteCard(e._id).then((()=>{C.setDeleteText(!0),e.removeCard(),C.close()})).catch(console.error).finally((()=>{C.setDeleteText(!1)}))}))}function x(e){return new h(e,n,B,q,U).getCard()}function U(e){k.updateLike(e._id,e.isLiked).then((t=>{console.log(t.isLiked),e.isCardLiked(t.isLiked)})).catch(console.error)}v.setEventListeners(),f.setEventListeners(),b.setEventListeners(),L.setEventListeners(),C.setEventListeners(),k.initialPageLoad().then((e=>{let[t,s]=e;S=new c({items:s,renderer:e=>{S.addItem(x(e))}},r),S.renderItems(),g=new E(i),g.setUserInfo(t.name,t.about),g.setUserAvatar(t.avatar)})).catch((e=>{console.error("There is an Error: ",e)})),e.addEventListener("click",(()=>{T["place-form"].toggleButtonState(),f.open()})),t.addEventListener("click",(()=>{y=g.getUserInfo(),b.setInputValues({title:y.name,description:y.job}),T["profile-form"].resetValidation(),b.open()})),s.addEventListener("click",(()=>{y=g.getUserInfo(),L.setInputValues({link:y.src}),T["avatar-form"].toggleButtonState(),L.open()}));const T={};var w;w={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(".modal__form")).forEach((e=>{const t=new _(w,e),s=e.getAttribute("name");T[s]=t,t.enableValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvQ29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoUGljdHVyZS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBDb25maXJtRGVsZXRlLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZ1wiLFxyXG4gIH0sXHJcbl07XHJcblxyXG5leHBvcnQgY29uc3QgYWRkTmV3Q2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0LWJ1dHRvblwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVNlbGVjdG9ycyA9IHtcclxuICBwcm9maWxlTmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBwcm9maWxlRGVzY3JpcHRpb246IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXHJcbiAgcHJvZmlsZUF2YXRhcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3Qgc2VsZWN0b3JzID0ge1xyXG4gIGNhcmRTZWN0aW9uOiBcIi5jYXJkc19fbGlzdFwiLFxyXG4gIGNhcmRUZW1wbGF0ZTogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gIHByZXZpZXdNb2RhbDogXCIjcHJldmlldy1pbWFnZS1tb2RhbFwiLFxyXG4gIG5ld0NhcmRNb2RhbDogXCIjYWRkLWNhcmQtbW9kYWxcIixcclxuICBlZGl0UHJvZmlsZU1vZGFsOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBjb25maXJtRGVsZXRlTW9kYWw6IFwiI2NvbmZpcm0tZGVsZXRlLW1vZGFsXCIsXHJcbiAgZWRpdEF2YXRhck1vZGFsOiBcIiNhdmF0YXItZWRpdC1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlRm9ybTogXCIjcHJvZmlsZS1mb3JtXCIsXHJcbiAgbmV3Q2FyZEZvcm06IFwiI3BsYWNlLWZvcm1cIixcclxuICBlZGl0QXZhdGFyRm9ybTogXCIjYXZhdGFyLWZvcm1cIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVDYXJkRGVsZXRlQ2xpY2ssXHJcbiAgICBoYW5kbGVDYXJkTGlrZVxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZERlbGV0ZUNsaWNrID0gaGFuZGxlQ2FyZERlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZExpa2UgPSBoYW5kbGVDYXJkTGlrZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vIENhcmQgTGlrZSBCdXR0b25cclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcylcclxuICAgICk7XHJcbiAgICAvLyBDYXJkIERlbGV0ZSBCdXR0b25cclxuICAgIHRoaXMuX2NhcmREZWxldGUgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkRGVsZXRlQ2xpY2sodGhpcylcclxuICAgICk7XHJcbiAgICAvLyBDYXJkIFByZXZpZXdcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbGluazogdGhpcy5fbGluaywgbmFtZTogdGhpcy5fbmFtZSB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZCgpIHtcclxuICAgIC8vIENyZWF0ZSBmcm9tIFRlbXBsYXRlXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgLy9nZXQgdGhlIGNhcmQgdmlld1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZXNjcmlwdGlvbi1jb250ZW50XCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xyXG4gICAgLy9zZXQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VCdXR0b24oKTtcclxuXHJcbiAgICAvL3JldHVybiB0aGUgY2FyZFxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgaXNDYXJkTGlrZWQoaXNMaWtlZCkge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XHJcbiAgICB0aGlzLl91cGRhdGVMaWtlQnV0dG9uKCk7XHJcbiAgfVxyXG5cclxuICBfdXBkYXRlTGlrZUJ1dHRvbigpIHtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGhhbmRsZUNhcmRMaWtlKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBzZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNldHRpbmdzLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRFbGVtZW50cykpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgcmV0dXJuO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0RWxlbWVudHMuZXZlcnkoXHJcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIGVycm9yTXNnRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JNc2dFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTXNnRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvck1zZ0VsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMgPSBbXHJcbiAgICAgIC4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvciksXHJcbiAgICBdO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBzZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnByZXBlbmQoaXRlbSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVSZW1vdGVDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVSZW1vdGVDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfaGFuZGxlUmVtb3RlQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUudGFyZ2V0ID09PSBlLmN1cnJlbnRUYXJnZXQpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgLy8gQ3JlYXRlIGFuIGVtcHR5IG9iamVjdFxyXG4gICAgY29uc3QgZm9ybVZhbHVlcyA9IHt9O1xyXG5cclxuICAgIC8vIEFkZCB0aGUgdmFsdWVzIG9mIHRoZSBmaWVsZHMgdG8gdGhpcyBvYmplY3RcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtVmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBSZXR1cm4gdGhlIHZhbHVlcyBvYmplY3RcclxuICAgIHJldHVybiBmb3JtVmFsdWVzO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIC8vIEhlcmUgeW91IGluc2VydCB0aGUgYHZhbHVlYCBieSB0aGUgYG5hbWVgIG9mIHRoZSBpbnB1dFxyXG4gICAgICBpbnB1dC52YWx1ZSA9IGRhdGFbaW5wdXQubmFtZV07XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgc2V0QnV0dG9uVGV4dChpc1NhdmluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNTYXZpbmcpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IoeyBwcm9maWxlTmFtZSwgcHJvZmlsZURlc2NyaXB0aW9uLCBwcm9maWxlQXZhdGFyIH0pIHtcclxuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZSk7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlRGVzY3JpcHRpb24pO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhcik7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIHNyYzogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmMsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gam9iO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihzcmMpIHtcclxuICAgIHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjID0gc3JjO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuLy8gSW1wb3J0IGFsbCBjbGFzc2VzXHJcbmltcG9ydCB7XHJcbiAgYWRkTmV3Q2FyZEJ1dHRvbixcclxuICBlZGl0UHJvZmlsZUJ1dHRvbixcclxuICBlZGl0QXZhdGFyQnV0dG9uLFxyXG4gIHNlbGVjdG9ycyxcclxuICBwcm9maWxlU2VsZWN0b3JzLFxyXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcclxufSBmcm9tIFwiLi4vdXRpbHMvQ29uc3RhbnRzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmRcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvclwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhQaWN0dXJlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aFBpY3R1cmVcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybVwiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm9cIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGlcIjtcclxuaW1wb3J0IFBvcHVwQ29uZmlybURlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cENvbmZpcm1EZWxldGVcIjtcclxuXHJcbi8vIENyZWF0ZSBpbnN0YW5jZXMgb2YgQ2xhc3Nlc1xyXG5jb25zdCBpbWFnZVByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhQaWN0dXJlKHNlbGVjdG9ycy5wcmV2aWV3TW9kYWwpO1xyXG5cclxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgc2VsZWN0b3JzLm5ld0NhcmRNb2RhbCxcclxuICBoYW5kbGVBZGRDYXJkU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0VXNlckluZm9Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHNlbGVjdG9ycy5lZGl0UHJvZmlsZU1vZGFsLFxyXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuZWRpdEF2YXRhck1vZGFsLFxyXG4gIGhhbmRsZUF2YXRhckVkaXRTdWJtaXRcclxuKTtcclxuXHJcbmNvbnN0IGRlbGV0ZUNhcmRQb3B1cCA9IG5ldyBQb3B1cENvbmZpcm1EZWxldGUoc2VsZWN0b3JzLmNvbmZpcm1EZWxldGVNb2RhbCk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIyZjVhYmJmZC02OTNkLTQ5NzMtODdhOC0yZThmYzcxMWFmNTFcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy9Jbml0aWFsaXplIGFsbCBpbnN0YW5jZXNcclxuaW1hZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxubmV3Q2FyZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRVc2VySW5mb1BvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmVkaXRBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmxldCBjYXJkU2VjdGlvbjtcclxubGV0IHVzZXJJbmZvO1xyXG5cclxuYXBpXHJcbiAgLmluaXRpYWxQYWdlTG9hZCgpXHJcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAgICB7XHJcbiAgICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGl0ZW0pKTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBzZWxlY3RvcnMuY2FyZFNlY3Rpb25cclxuICAgICk7XHJcbiAgICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG5cclxuICAgIHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZpbGVTZWxlY3RvcnMpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1c2VyRGF0YS5hdmF0YXIpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoYFRoZXJlIGlzIGFuIEVycm9yOiBgLCBlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgfSk7XHJcblxyXG4vL1NwZWNpZmljIEV2ZW50IExpc3RlbmVyc1xyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwbGFjZS1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgbmV3Q2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5sZXQgdXNlckRhdGE7XHJcblxyXG5lZGl0UHJvZmlsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0VXNlckluZm9Qb3B1cC5zZXRJbnB1dFZhbHVlcyh7XHJcbiAgICB0aXRsZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5qb2IsXHJcbiAgfSk7XHJcbiAgZm9ybVZhbGlkYXRvcnNbXCJwcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgZWRpdFVzZXJJbmZvUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICB1c2VyRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnNldElucHV0VmFsdWVzKHtcclxuICAgIGxpbms6IHVzZXJEYXRhLnNyYyxcclxuICB9KTtcclxuICBmb3JtVmFsaWRhdG9yc1tcImF2YXRhci1mb3JtXCJdLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyBGdW5jdGlvbnNcclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhsaW5rLCBuYW1lKSB7XHJcbiAgaW1hZ2VQcmV2aWV3UG9wdXAub3BlbihsaW5rLCBuYW1lKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIHBvcHVwSW5zdGFuY2UsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xyXG4gIHBvcHVwSW5zdGFuY2Uuc2V0QnV0dG9uVGV4dCh0cnVlLCBsb2FkaW5nVGV4dCk7XHJcbiAgcmVxdWVzdCgpXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIC8vIFdlIG5lZWQgdG8gY2xvc2Ugb25seSBpbiBgdGhlbmBcclxuICAgICAgcG9wdXBJbnN0YW5jZS5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC8vIHdlIG5lZWQgdG8gY2F0Y2ggcG9zc2libGUgZXJyb3JzXHJcbiAgICAvLyBjb25zb2xlLmVycm9yIGlzIHVzZWQgdG8gaGFuZGxlIGVycm9ycyBpZiB5b3UgZG9u4oCZdCBoYXZlIGFueSBvdGhlciB3YXlzIGZvciB0aGF0XHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC8vIGluIGBmaW5hbGx5YCB3ZSBuZWVkIHRvIHJldHVybiB0aGUgaW5pdGlhbCBidXR0b24gdGV4dCBiYWNrIGluIGFueSBjYXNlXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwSW5zdGFuY2Uuc2V0QnV0dG9uVGV4dChmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgLy8gYHJldHVybmAgbGV0cyB1cyB1c2UgYSBwcm9taXNlIGNoYWluIGB0aGVuLCBjYXRjaCwgZmluYWxseWAgaW5zaWRlIGBoYW5kbGVTdWJtaXRgXHJcbiAgICByZXR1cm4gYXBpLmFkZE5ld0NhcmQoY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmxpbmspLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjcmVhdGVDYXJkKGRhdGEpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBuZXdDYXJkUG9wdXApO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChjYXJkRGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgcmV0dXJuIGFwaS5lZGl0VXNlckluZm8oY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmRlc2NyaXB0aW9uKS50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oY2FyZERhdGEudGl0bGUsIGNhcmREYXRhLmRlc2NyaXB0aW9uKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaGFuZGxlU3VibWl0KG1ha2VSZXF1ZXN0LCBlZGl0VXNlckluZm9Qb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckVkaXRTdWJtaXQoZGF0YSkge1xyXG4gIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KCkge1xyXG4gICAgcmV0dXJuIGFwaS51cGRhdGVBdmF0YXIoZGF0YS5saW5rKS50aGVuKCgpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihkYXRhLmxpbmspO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBoYW5kbGVTdWJtaXQobWFrZVJlcXVlc3QsIGVkaXRBdmF0YXJQb3B1cCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmREZWxldGVDbGljayhjYXJkKSB7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuXHJcbiAgZGVsZXRlQ2FyZFBvcHVwLnNldENvbmZpcm1EZWxldGUoKCkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuX2lkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldERlbGV0ZVRleHQodHJ1ZSk7XHJcbiAgICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLnNldERlbGV0ZVRleHQoZmFsc2UpO1xyXG4gICAgICB9KTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gbmV3IENhcmQoXHJcbiAgICBjYXJkRGF0YSxcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUsXHJcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZERlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlQ2FyZExpa2VcclxuICApO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudC5nZXRDYXJkKCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRMaWtlKGRhdGEpIHtcclxuICBhcGlcclxuICAgIC51cGRhdGVMaWtlKGRhdGEuX2lkLCBkYXRhLmlzTGlrZWQpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKHJlcy5pc0xpa2VkKTtcclxuICAgICAgZGF0YS5pc0NhcmRMaWtlZChyZXMuaXNMaWtlZCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG4vL1xyXG5cclxuLy8gVmFsaWRhdGlvblxyXG5jb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG5cclxuY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9ICh2YWxpZGF0aW9uU2V0dGluZ3MpID0+IHtcclxuICBjb25zdCBmb3JtTGlzdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9fZm9ybVwiKSk7XHJcblxyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XHJcbiAgICBjb25zdCB2YWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KTtcclxuICAgIC8vIEhlcmUgeW91IGdldCB0aGUgbmFtZSBvZiB0aGUgZm9ybSAoaWYgeW91IGRvbuKAmXQgaGF2ZSBpdCB0aGVuIHlvdSBuZWVkIHRvIGFkZCBpdCBpbnRvIGVhY2ggZm9ybSBpbiBgaW5kZXguaHRtbGAgZmlyc3QpXHJcbiAgICBjb25zdCBmb3JtTmFtZSA9IGZvcm1FbGVtZW50LmdldEF0dHJpYnV0ZShcIm5hbWVcIik7XHJcblxyXG4gICAgLy8gSGVyZSB5b3Ugc3RvcmUgdGhlIHZhbGlkYXRvciB1c2luZyB0aGUgYG5hbWVgIG9mIHRoZSBmb3JtXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtTmFtZV0gPSB2YWxpZGF0b3I7XHJcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbih2YWxpZGF0aW9uU2V0dGluZ3MpO1xyXG5cclxuLy9cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhQaWN0dXJlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcG9wdXBJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlLXByZXZpZXdcIik7XHJcbiAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIubW9kYWxfX2hlYWRpbmctcHJldmlld1wiXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb3BlbihkYXRhKSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fcG9wdXBDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXBcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwQ29uZmlybURlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQ29uZmlybUZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBcIi5tb2RhbF9fYnV0dG9uLWRlbGV0ZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICB9XHJcblxyXG4gIHNldENvbmZpcm1EZWxldGUoZnVuYykge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGZ1bmM7XHJcbiAgfVxyXG5cclxuICBzZXREZWxldGVUZXh0KGlzRGVsZXRpbmcpIHtcclxuICAgIGlmIChpc0RlbGV0aW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiRGVsZXRpbmcuLi5cIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jbG9zZUNvbmZpcm1Gb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgaWYgKHJlcy5vaykge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgIH1cclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVkaXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWU6IHRpdGxlLFxyXG4gICAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQobmFtZSwgbGluaykge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUxpa2UoaWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7aWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgaW5pdGlhbFBhZ2VMb2FkKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImFkZE5ld0NhcmRCdXR0b24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJwcm9maWxlU2VsZWN0b3JzIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwic2VsZWN0b3JzIiwiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVDYXJkRGVsZXRlQ2xpY2siLCJoYW5kbGVDYXJkTGlrZSIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlQ2FyZERlbGV0ZUNsaWNrIiwiX2hhbmRsZUNhcmRMaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2NhcmREZWxldGUiLCJfY2FyZEltYWdlIiwiZ2V0Q2FyZCIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJzcmMiLCJ0ZXh0Q29udGVudCIsImFsdCIsIl91cGRhdGVMaWtlQnV0dG9uIiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsImlzQ2FyZExpa2VkIiwiY2xhc3NMaXN0IiwiYWRkIiwidG9nZ2xlIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJyZXNldFZhbGlkYXRpb24iLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dEVsZW1lbnRzIiwiZm9yRWFjaCIsImlucHV0RWxlbWVudCIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJkaXNhYmxlQnV0dG9uIiwiX2VuYWJsZUJ1dHRvbiIsIl9zdWJtaXRCdXR0b24iLCJkaXNhYmxlZCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJfc2hvd0lucHV0RXJyb3IiLCJlcnJvck1zZ0VsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwicXVlcnlTZWxlY3RvckFsbCIsImUiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiX3JlZiIsInNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9lbGVtZW50IiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiaXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsIl9oYW5kbGVSZW1vdGVDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJzZXRFdmVudExpc3RlbmVycyIsIl9jbG9zZUJ1dHRvbiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldElucHV0VmFsdWVzIiwic2V0QnV0dG9uVGV4dCIsImlzU2F2aW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJVc2VySW5mbyIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImpvYiIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsImltYWdlUHJldmlld1BvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBDYXB0aW9uIiwibmV3Q2FyZFBvcHVwIiwiY2FyZERhdGEiLCJoYW5kbGVTdWJtaXQiLCJhcGkiLCJhZGROZXdDYXJkIiwidGl0bGUiLCJ0aGVuIiwiY2FyZFNlY3Rpb24iLCJjcmVhdGVDYXJkIiwiZWRpdFVzZXJJbmZvUG9wdXAiLCJlZGl0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInVzZXJJbmZvIiwiZWRpdEF2YXRhclBvcHVwIiwidXBkYXRlQXZhdGFyIiwiZGVsZXRlQ2FyZFBvcHVwIiwiX2Nsb3NlQ29uZmlybUZvcm0iLCJzZXRDb25maXJtRGVsZXRlIiwiZnVuYyIsInNldERlbGV0ZVRleHQiLCJpc0RlbGV0aW5nIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJnZXRJbml0aWFsQ2FyZHMiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiZGVsZXRlQ2FyZCIsImF2YXRhciIsInVwZGF0ZUxpa2UiLCJpbml0aWFsUGFnZUxvYWQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwidXNlckRhdGEiLCJyZXF1ZXN0IiwicG9wdXBJbnN0YW5jZSIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwiZmluYWxseSIsImNhcmQiLCJsb2ciLCJjYXJkcyIsImVyciIsImZvcm1WYWxpZGF0b3JzIiwidmFsaWRhdGlvblNldHRpbmdzIiwiQXJyYXkiLCJmcm9tIiwidmFsaWRhdG9yIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9